### 画面遷移図

flowchart TD
    Login[ログイン画面] --> Top[トップページ]
    
    %% ダッシュボードからのメイン遷移
    Sidebar[サイドバー] --> TaskList[タスクページ]
    Sidebar --> TimeList[時間ページ]
    Sidebar --> WorkList[実績入力ページ]
    Sidebar --> Top

    %% タスク一覧からの遷移
    TaskList --> TaskDetail[タスク詳細ページ]
    TaskList --> TaskUpdate[タスク更新ページ]
    TaskList --> TaskDelete[タスク削除ページ]
    TaskList --> TaskCreate[タスク作成ページ]
    
    TimeList --> TaskDetail[タスク詳細ページ]

    WorkList --> TimeUpdate[作業時間修正ページ]
    WorkList --> TimeDelete[作業時間削除ページ]
    WorkList --> WorkUpdate[作業実績修正ページ]
    WorkList --> WorkDelete[作業実績削除ページ]
    WorkList --> Workinput[作業実績入力ページ]
    WorkList --> Timeinput[作業時間入力ページ]
    
    Top["
            <b>トップページ</b>
            ・合算のタスク進捗率（グラフ）
            ・合算のタスク時間進捗率（グラフ）
            ・ガントチャートみたいなスケジュールのグラフ
        "]
    TaskList["
            <b>タスクページ</b>
            ・タスク一覧（グラフ、内容、修正削除ボタン）
            ・タスク作成ボタン
        "]
    TimeList["
            <b>時間ページ</b>
            ・タスク時間一覧（グラフ、内容）
        "]
    WorkList["
        <b>実績入力ページ</b>
        ・作業実績履歴（内容、修正削除ボタン）
        ・時間実績履歴（内容、修正削除ボタン）
    "]
    
    %% スタイル設定
    classDef primary fill:#4285F4,stroke:#333,stroke-width:1px,color:white
    classDef secondary fill:#34A853,stroke:#333,stroke-width:1px,color:white
    classDef createupdate fill:#FBBC05,stroke:#333,stroke-width:1px,color:white
    classDef danger fill:#EA4335,stroke:#333,stroke-width:1px,color:white
    
    class Login,Sidebar,Top primary
    class TaskList,TimeList,WorkList secondary
    class TaskUpdate,WorkUpdate,TimeUpdate,TaskCreate,Workinput,Timeinput createupdate
    class WorkDelete,TimeDelete,TaskDelete danger



### タスク作成ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - tasksテーブルのレコードを作成する
        - subtasksテーブルのレコードを作成する
        - daily_task_plansテーブルのレコードを作成する
        - daily_time_plansテーブルのレコードを作成する
        - subtasksテーブルのレコードを作成する
        - 各サブタスクの作業貢献値の合計値が100かチェックを行い、100でないならエラーを出す
        - タスクの各日の作業計画値の合計値が100かチェックを行い、100でないならエラーを出す
        - タスクの各日の作業時間計画値の合計値が目標作業時間と等しいかチェックを行い、等しくないならエラーを出す
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
        - 開始予定日と完了予定日の値を受け取り、タスクの日毎の作業計画値の初期値を算出（100/(タスク日数)）し、表示する
        - 開始予定日と完了予定日と目標作業時間の値を受け取り、タスクの日毎の作業時間計画値の初期値を算出（(目標作業時間)/タスク日数）し、表示する
        - 追加したサブタスク数をカウントした数を受け取り、各サブタスクの作業貢献値の初期値を算出（100/(サブタスク数)）し、表示する
        - エラーを受け取り、表示する
- 入力
    - タスク名
    - タスク内容
    - 直近の予定
    - 開始予定日
    - 完了予定日
    - カテゴリー
    - 目標作業時間
    - コメント
    - 各サブタスク情報（サブタスクは複数作成可能）
        - サブタスク名
        - 作業貢献値（初期値：100/(サブタスク数)）
    - 作業計画値（開始予定日から完了予定日まで1日毎に設定）（初期値：100/(タスク日数)）
    - 作業時間計画値（開始予定日から完了予定日まで1日毎に設定）（初期値：(目標作業時間)/(タスク日数)）
- 出力
    - tasksテーブル新規レコード
        - task_id =自動採番
        - user_id =ログインユーザー
        - task_name =タスク名
        - task_content =タスク内容
        - recent_schedule =直近の予定
        - start_date =開始予定日
        - due_date =完了予定日
        - category =カテゴリー
        - target_time =目標作業時間
        - comment =コメント
    - subtasksテーブル新規レコード
        - subtask_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - subtask_name =サブタスク名
        - contribution_value =作業実績値
        - completion_rate =0
    - daily_task_plansテーブル新規レコード（開始予定日から完了予定日までの日分作成される）
        - daily_task_plan_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - date =該当日
        - task_plan_value =作業計画値
    - daily_time_plansテーブル新規レコード（開始予定日から完了予定日までの日分作成される）
        - daily_time_plan_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - date =該当日
        - time_plan_value =作業時間計画値

### 作業時間入力ページ（タスク毎に用意）

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - work_timesテーブルのレコードを作成する
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 選択したタスクのidでtasksテーブルを検索し、結果を出力する
- 入力
    - 作業日（初期値：当日）
    - 作業時間
- 出力
    - work_timesテーブル新規レコード
        - work_time_id =自動採番
        - task_id =選択したタスクのtask_id
        - date =作業日
        - work_time =作業時間

### 作業時間修正ページ（作業時間入力履歴の欄から選択）

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - work_timesテーブルのレコードを更新する
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 選択した作業時間(work_timesテーブル)のidでwork_timesテーブルを検索し、結果を出力する
    - JSON値または入力値を受け取り、ウェブ画面を作成するシステム
        - work_timesテーブルのレコードデータを受け取り、初期値として表示する
- 入力
    - 作業日（初期値：当日）
    - 作業時間
- 出力
    - work_timesテーブル新規レコード
        - work_time_id =自動採番
        - task_id =選択したタスクのtask_id
        - date =作業日
        - work_time =作業時間

### 作業実績入力ページ（サブタスクをキーにrecord_worksを作成する）

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - record_worksテーブルのレコードを作成する
        - 入力された作業実績値を受けて、選択サブタスクの作業完了率を算出し、100を超えるならエラーを出す
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 選択したタスクのidでsubtasksテーブルを検索し、サブタスクのレコードを全て取得する
        - 選択したサブタスクの現状の作業完了率を算出して、出力する
    - JSON値または入力値を受け取り、ウェブ画面を作成するシステム
        - エラーを受け取り、表示するシステム
        - 算出して取得した現状の作業完了率を表示する
- 入力
    - 作業実績値
    - 作業日
- 出力
    - record_worksテーブルのレコードの作成
        - record_work_id =自動採番
        - subtask_id =選択したサブタスクのid
        - date =作業日
        - work =作業実績値

### タスクページ

- 必要モジュール
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 作成者が自分または自分が所属するグループに閲覧権限があるタスクのレコードを一覧で取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、各タスクの累積作業計画値を算出して取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、各タスクの累積作業実績値を算出して取得する
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
        - 一覧で取得したタスクのレコードを表示する
        - 各タスクの欄に、タスクの日毎の累積作業計画値を時系列折れ線グラフで表示する
        - 上記のグラフに重ねて、タスクの日毎の累積作業実績値を時系列折れ線グラフで表示する
- 入力は無し
- 出力
    - 自分の全てのタスクの内容を一覧で表示
    - 自分のタスクの累積作業実績値と累積作業計画値をグラフで時系列で一覧で表示

### タスク詳細ページ

- タスクに紐づくテーブルのデータを全て表示する

### トップページ（全体スケジュール）

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
- 入力は無し
- 自分の全てのタスクの開始予定日と完了予定日をまとめて、ガントチャートみたいに表示

### トップページ（合算のタスク進捗率、合算のタスク時間進捗率）

- 必要モジュール
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 作成者が自分または自分が所属するグループに閲覧権限がある、全タスク合算の累積作業計画値を算出して取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、全タスク合算の累積作業実績値を算出して取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、全タスク合算の累積作業時間計画値を算出して取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、全タスク合算の累積作業時間実績値を算出して取得する
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
        - 全タスク合算の日毎の累積作業計画値を時系列折れ線グラフで表示する
        - 上記のグラフに重ねて、全タスク合算の日毎の累積作業実績値を時系列折れ線グラフで表示する
        - 全タスク合算の日毎の累積作業時間計画値を時系列折れ線グラフで表示する
        - 上記のグラフに重ねて、全タスク合算の日毎の累積作業時間実績値を時系列折れ線グラフで表示する
- 入力は無し
- 出力
    - 自分の全てのタスクの累積作業実績値と累積作業計画値の総計をグラフで時系列で表示
    - 自分の全てのタスクの累積作業時間実績値と累積作業時間計画値の総計をグラフで時系列で表示

### タスク時間一覧表示ページ

- 必要モジュール
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 作成者が自分または自分が所属するグループに閲覧権限があるタスクのレコードを一覧で取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、各タスクの累積作業時間計画値を算出して取得する
        - 作成者が自分または自分が所属するグループに閲覧権限がある、各タスクの累積作業時間実績値を算出して取得する
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
        - 一覧で取得したタスクのレコードを表示する
        - 各タスクの欄に、タスクの日毎の累積作業時間計画値を時系列折れ線グラフで表示する
        - 上記のグラフに重ねて、タスクの日毎の累積作業時間実績値を時系列折れ線グラフで表示する
- 入力は無し
- 出力
    - 自分の全てのタスクの内容を一覧で表示
    - 自分ののタスクの累積作業時間実績値と累積作業時間計画値をグラフで時系列で一覧で表示

### タスク更新ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - tasksテーブルを更新する
        - subtasksテーブルを更新する
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
        - 選択したタスクのレコードを取得
        - 選択したタスクに紐づくサブタスクの一覧を取得
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
- 入力に基づいて選択したタスクを更新します

### タスク削除ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
- 選択したタスクを削除します

### 作業時間更新ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
- 入力内容に基づいて選択した作業時間レコードを更新します

### 作業時間削除ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
    - JSON値を受け取り、テーブルを照会し、結果をJSON値で返すシステム
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
- 選択した作業時間レコードを削除します