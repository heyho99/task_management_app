### タスク作成ページ

- 必要モジュール
    - JSONの値を受け取り、テーブルを作成・更新・削除するシステム
        - tasksテーブルのレコードを作成する
        - subtasksテーブルのレコードを作成する
        - daily_task_plansテーブルのレコードを作成する
        - daily_time_plansテーブルのレコードを作成する
        - subtasksテーブルのレコードを作成する
        - 各サブタスクの作業貢献値の合計値が100かチェックを行い、100でないならエラーを出す
        - タスクの各日の作業計画値の合計値が100かチェックを行い、100でないならエラーを出す
        - タスクの各日の作業時間計画値の合計値が目標作業時間と等しいかチェックを行い、等しくないならエラーを出す
    - JSON値または入力値を受け取って処理をし、ウェブ画面を作成するシステム
        - 開始予定日と完了予定日の値を受け取り、タスクの日毎の作業計画値の初期値を算出（100/(タスク日数)）し、表示する
        - 開始予定日と完了予定日と目標作業時間の値を受け取り、タスクの日毎の作業時間計画値の初期値を算出（(目標作業時間)/タスク日数）し、表示する
        - 追加したサブタスク数をカウントした数を受け取り、各サブタスクの作業貢献値の初期値を算出（100/(サブタスク数)）し、表示する
        - エラーを受け取り、表示する
- 入力
    - タスク名
    - タスク内容
    - 直近の予定
    - 開始予定日
    - 完了予定日
    - カテゴリー
    - 目標作業時間
    - コメント
    - 各サブタスク情報（サブタスクは複数作成可能）
        - サブタスク名
        - 作業貢献値（初期値：100/(サブタスク数)）
    - 作業計画値（開始予定日から完了予定日まで1日毎に設定）（初期値：100/(タスク日数)）
    - 作業時間計画値（開始予定日から完了予定日まで1日毎に設定）（初期値：(目標作業時間)/(タスク日数)）
- 出力
    - tasksテーブル新規レコード
        - task_id =自動採番
        - user_id =ログインユーザー
        - task_name =タスク名
        - task_content =タスク内容
        - recent_schedule =直近の予定
        - start_date =開始予定日
        - due_date =完了予定日
        - category =カテゴリー
        - target_time =目標作業時間
        - comment =コメント
    - subtasksテーブル新規レコード
        - subtask_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - subtask_name =サブタスク名
        - contribution_value =作業実績値
        - completion_rate =0
    - daily_task_plansテーブル新規レコード（開始予定日から完了予定日までの日分作成される）
        - daily_task_plan_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - date =該当日
        - task_plan_value =作業計画値
    - daily_time_plansテーブル新規レコード（開始予定日から完了予定日までの日分作成される）
        - daily_time_plan_id =自動採番
        - task_id =tasksテーブル新規レコードの値と同じ
        - date =該当日
        - time_plan_value =作業時間計画値



### 各機能のアルゴリズム

- タスク作業系
    - タスク日数=(完了予定日(due_date))-(開始予定日(start_date))
    - 日毎に加算される作業計画値：daily_task_plansテーブルのtask_plan_valueが日毎に設定される
    - 累積作業計画値：タスク期間内の日毎に作業計画値(task_plan_value)が累積していき、開始予定日前の値は0で完了予定日の値は100になる
    - あるタスクの日毎に加算される作業計画値(task_plan_value)の初期値=100/(タスク日数)
    - あるタスクの日毎に加算される作業計画値(task_plan_value)は変更可能であり、変更すると完了時の累積作業計画値が100ではなくなるので、エラーを出すようにする
        
        →他の日の日毎に加算される作業計画値(task_plan_value)を変更して100に合わせるようにする（ユーザーに手動で調整を促す）
        
- サブタスク系
    - サブタスク数：タスクに登録されているサブタスクの数
    - 作業貢献値：各サブタスクのcontribution_valueの値（0~100）
    - （ある日の）作業完了率：各サブタスクに紐づくrecord_workテーブルのworkの値(作業記録値)の、該当日以前までの累積の値
    - （ある日の）サブタスク作業実績値：(サブタスクの作業貢献値)/100)*((サブタスクの完了率)/100)*100
    - タスク作業実績値：あるタスクに登録されている全てのサブタスクの作業貢献値(contribution_value)と作業完了率から算出される
    →あるタスクのある日のタスク作業実績値=Σ{((サブタスクiの作業貢献値)/100)*((サブタスクiの作業完了率)/100)*100}
    - あるタスクに登録されている全てのサブタスクの作業貢献値(contribution_value)の合計は100になる
    - ユーザーは作業実績入力ページから、あるサブタスクに紐づくrecord_worksテーブルのレコードを都度作成していき、作業完了率はworkフィールドの値を累積したものになり、完了時には累積した値が100になる
    - あるサブタスクの作業貢献値(contribution_value)の初期値=100/(サブタスク数)
    - あるタスクに登録されている各サブタスクの作業貢献値は変更可能であり、変更するとタスクに登録されている全てのサブタスクの作業値の貢献合計が100ではなくなるので、エラーを出すようにする
        
        →他のサブタスクの作業貢献値を変更して100に合わせるようにする（ユーザーに手動で調整を促す）
        
- タスク時間設定系
    - タスク日数=(完了予定日(due_date))-(開始予定日(start_date))
    - 日毎に加算される作業時間計画値：daily_time_plansテーブルのtime_plan_valueが日毎に設定される
    - 目標作業時間：taskテーブルのtarget_timeの値
    - 累積作業時間計画値：タスク期間内の日毎に作業時間計画値(time_plan_value)が累積していき、開始予定日前の値は0で完了予定日の値は目標作業時間と等しくなる
    - あるタスクの日毎に加算される作業時間計画値(time_plan_value)の初期値=(目標作業時間)/(タスク日数)
    - あるタスクの日毎に加算される作業時間計画値(time_plan_value)は変更可能であり、変更すると完了時の累積作業時間計画値が目標作業時間と同じではなくなるので、エラーを出すようにする
        
        →他の日の日毎に加算される作業時間計画値(time_plan_value)を変更して目標作業時間に合わせるようにする（ユーザーに手動で調整を促す）
        
- 時間記録系
    - 累積作業時間実績値：あるタスクの開始予定日から該当日までの作業時間実績値の累積の値。日毎に集計される。